# Collections 功能说明

## 概述

Collections 功能是 InstaGo Web 应用的一个新特性，它允许用户根据 AI 标签自动分类和组织截图，提供类似 iOS 应用的合集管理体验。

## 功能特性

### 1. 自动分类
- 系统根据截图的 `ai_tags` 字段自动创建合集
- 每个 AI 标签对应一个合集
- 支持多标签截图（一个截图可以属于多个合集）

### 2. 合集展示
- **网格视图**: 卡片式布局，显示合集预览图、名称和数量
- **列表视图**: 紧凑的列表布局，适合快速浏览
- 每个合集显示：
  - 预览图片（使用第一张截图的缩略图）
  - 合集名称（AI 标签）
  - 截图数量
  - 最新截图时间
  - 前几张截图的缩略图预览

### 3. 搜索和筛选
- 支持按合集名称搜索
- 实时搜索结果过滤
- 合集按数量自动排序（数量多的排在前面）

### 4. 合集详情
- 点击合集卡片查看详情
- 模态框显示合集内所有截图
- 支持截图预览和查看

### 5. 截图查看
- 集成现有的 ScreenshotDetailModal 组件
- 支持在合集内导航查看截图
- 键盘快捷键支持（左右箭头键切换）

## 技术实现

### 文件结构
```
src/app/collections/
└── page.tsx          # Collections 主页面

src/components/
└── Navbar.tsx        # 导航栏（已更新，添加 Collections 入口）
```

### 核心组件

#### CollectionsPage
- 主要的状态管理和业务逻辑
- 使用 `useScreenshotCache` 钩子获取截图数据
- 根据 `ai_tags` 自动生成合集数据
- 支持网格和列表两种视图模式

#### 数据流
1. 从 `useScreenshotCache` 获取所有截图
2. 解析每个截图的 `ai_tags` 字段
3. 按标签分组创建合集
4. 为每个合集生成预览图和统计信息
5. 按数量排序并渲染到界面

### 状态管理
```typescript
interface Collection {
  name: string          // 合集名称（AI 标签）
  count: number         // 截图数量
  screenshots: Screenshot[]  // 截图数组
  previewImage?: string      // 预览图片 URL
  description?: string       // 描述信息
}
```

## 使用方法

### 1. 访问 Collections
- 在导航栏点击 "Collections" 按钮
- 或直接访问 `/collections` 路径

### 2. 浏览合集
- 默认显示网格视图
- 可以切换到列表视图
- 使用搜索框快速找到特定合集

### 3. 查看合集详情
- 点击任意合集卡片
- 在模态框中浏览合集内的所有截图
- 点击截图查看详细信息

### 4. 导航快捷键
- 在截图详情模态框中：
  - 左箭头键：上一张截图
  - 右箭头键：下一张截图
  - ESC 键：关闭模态框

## 样式设计

### 设计原则
- 参考 iOS 应用的简洁设计风格
- 使用卡片式布局展示合集
- 响应式设计，支持不同屏幕尺寸

### 颜色方案
- 主色调：蓝色（#3B82F6）
- 背景：浅灰色（#F9FAFB）
- 卡片：白色背景，灰色边框
- 文字：深灰色（#111827）

### 布局特点
- 顶部固定导航栏
- 页面标题和统计信息
- 搜索和视图控制区域
- 响应式网格布局
- 模态框覆盖层

## 性能优化

### 缓存策略
- 使用 `useScreenshotCache` 钩子管理截图数据
- 支持缩略图缓存
- 自动刷新机制（15分钟间隔）

### 图片优化
- 使用缩略图减少加载时间
- 懒加载支持
- 响应式图片尺寸

## 未来改进

### 功能增强
- [ ] 手动创建和编辑合集
- [ ] 合集重命名和删除
- [ ] 截图在合集间移动
- [ ] 合集分享功能
- [ ] 导出合集功能

### 用户体验
- [ ] 拖拽排序
- [ ] 批量操作
- [ ] 高级筛选选项
- [ ] 合集模板

### 技术优化
- [ ] 虚拟滚动支持大量数据
- [ ] 图片预加载
- [ ] 离线支持
- [ ] PWA 功能

## 注意事项

1. **AI 标签依赖**: 功能完全依赖截图的 `ai_tags` 字段，确保上传的截图包含有效的 AI 标签
2. **性能考虑**: 大量截图时可能需要分页或虚拟滚动
3. **图片加载**: 建议使用缩略图以提高性能
4. **响应式设计**: 在不同设备上测试布局效果

## 故障排除

### 常见问题

**Q: 没有显示任何合集**
A: 检查是否有上传的截图，以及截图是否包含 `ai_tags` 字段

**Q: 合集图片不显示**
A: 检查截图是否有有效的 `thumbnail_url` 或 `image_url`

**Q: 搜索功能不工作**
A: 确保搜索框有输入内容，合集名称包含搜索关键词

**Q: 模态框无法关闭**
A: 使用 ESC 键或点击关闭按钮，检查是否有 JavaScript 错误

### 调试信息
- 打开浏览器开发者工具查看控制台错误
- 检查网络请求是否成功
- 验证数据结构是否符合预期
